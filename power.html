<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Power Tracker â€” Add/Edit Players</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600,700&display=swap" rel="stylesheet">
<style>
body { font-family: Inter,sans-serif; margin:0; background:#f8fafc; color:#1e293b; }
header { background:#1e40af; color:#fff; padding:1rem 1.5rem; display:flex; justify-content:space-between; align-items:center;}
header h1 { margin:0; font-size:1.25rem; }
nav { display:flex; justify-content:center; gap:10px; padding:0.75rem; background:#e2e8f0; }
nav a { color:#fff; text-decoration:none; padding:.6rem 1rem; background:#3b82f6; border-radius:6px; font-weight:600; }
nav a:hover { opacity:.9; transform:translateY(-1px); }
main { max-width:900px; margin:1rem auto; padding:0 1rem; display:grid; gap:1rem; grid-template-columns:1fr 1fr; }
.section { background:#fff; padding:1rem; border-radius:12px; box-shadow:0 3px 10px rgba(0,0,0,0.05); }
.input { width:100%; padding:.5rem; border:1px solid #ccc; border-radius:8px; font-size:.95rem; margin-bottom:.5rem; }
.button { padding:.5rem .8rem; border:none; border-radius:8px; cursor:pointer; font-weight:600; }
.button.save { background:#10b981; color:#fff; }
.button.delete { background:#ef4444; color:#fff; }
.button.cancel { background:#6b7280; color:#fff; }
.players-list { list-style:none; padding:0; margin:0; max-height:250px; overflow:auto; }
.players-list li { display:flex; justify-content:space-between; padding:.4rem .6rem; border-bottom:1px solid #eee; cursor:pointer; }
.players-list li.selected { background:#dbeafe; }
.date-input { width:100%; padding:.5rem; border:1px solid #ccc; border-radius:8px; margin-bottom:.5rem; }
</style>
</head>
<body>
<header>
  <h1>Power Tracker</h1>
</header>
<nav>
  <a href="index.html">Dashboard</a>
  <a href="compare.html">Compare</a>
</nav>

<main>
  <!-- Player Management -->
  <section class="section">
    <h2>Players</h2>
    <input id="playerNameInput" class="input" placeholder="Enter player name">
    <div style="display:flex; gap:.5rem; margin-bottom:.5rem;">
      <button id="addPlayerBtn" class="button save">Add Player</button>
      <button id="deletePlayerBtn" class="button delete">Delete Selected</button>
    </div>
    <ul id="playersList" class="players-list"></ul>
  </section>

  <!-- Power Logging -->
  <section class="section">
    <h2>Add Power Entry</h2>
    <input type="date" id="entryDate" class="date-input">
    <input type="number" id="entryPower" class="input" placeholder="Power">
    <div style="display:flex; gap:.5rem;">
      <button id="saveEntryBtn" class="button save">Save Entry</button>
      <button id="deleteEntryBtn" class="button delete">Delete Entry</button>
    </div>
    <ul id="entriesList" class="players-list"></ul>
  </section>
</main>

<script>
(function(){
  const playerNameInput = document.getElementById('playerNameInput');
  const addPlayerBtn = document.getElementById('addPlayerBtn');
  const deletePlayerBtn = document.getElementById('deletePlayerBtn');
  const playersList = document.getElementById('playersList');

  const entryDate = document.getElementById('entryDate');
  const entryPower = document.getElementById('entryPower');
  const saveEntryBtn = document.getElementById('saveEntryBtn');
  const deleteEntryBtn = document.getElementById('deleteEntryBtn');
  const entriesList = document.getElementById('entriesList');

  let selectedPlayer = null;
  let selectedEntryId = null;

  // Load from localStorage
  function loadPlayers() {
    return JSON.parse(localStorage.getItem('players')||'[]');
  }
  function savePlayers(players) {
    localStorage.setItem('players', JSON.stringify(players));
  }
  function loadEntries() {
    return JSON.parse(localStorage.getItem('entries')||'[]');
  }
  function saveEntries(entries) {
    localStorage.setItem('entries', JSON.stringify(entries));
  }

  function renderPlayers() {
    const players = loadPlayers();
    playersList.innerHTML = '';
    players.forEach(name => {
      const li = document.createElement('li');
      li.textContent = name;
      li.dataset.name = name;
      if(selectedPlayer===name) li.classList.add('selected');
      playersList.appendChild(li);
    });
    renderEntries();
  }

  function renderEntries() {
    if(!selectedPlayer){
      entriesList.innerHTML='<li style="color:#555">Select a player to see entries</li>';
      return;
    }
    const entries = loadEntries().filter(e=>e.player===selectedPlayer);
    if(!entries.length){
      entriesList.innerHTML='<li style="color:#555">No entries yet</li>';
      return;
    }
    entriesList.innerHTML='';
    entries.sort((a,b)=>new Date(a.date)-new Date(b.date)).forEach(e=>{
      const li = document.createElement('li');
      li.textContent = `${e.date}: ${e.power}`;
      li.dataset.id = e.id;
      if(selectedEntryId===e.id) li.classList.add('selected');
      entriesList.appendChild(li);
    });
  }

  // Player Events
  addPlayerBtn.addEventListener('click', ()=>{
    const name = playerNameInput.value.trim();
    if(!name) return alert('Enter name');
    let players = loadPlayers();
    if(players.includes(name)) return alert('Player exists');
    players.push(name);
    savePlayers(players);
    playerNameInput.value='';
    renderPlayers();
  });

  deletePlayerBtn.addEventListener('click', ()=>{
    if(!selectedPlayer) return alert('Select player');
    if(!confirm(`Delete player "${selectedPlayer}" and all entries?`)) return;
    let players = loadPlayers().filter(p=>p!==selectedPlayer);
    savePlayers(players);
    let entries = loadEntries().filter(e=>e.player!==selectedPlayer);
    saveEntries(entries);
    selectedPlayer=null;
    selectedEntryId=null;
    renderPlayers();
  });

  playersList.addEventListener('click', e=>{
    const li = e.target.closest('li');
    if(!li) return;
    selectedPlayer = li.dataset.name;
    selectedEntryId=null;
    renderPlayers();
  });

  // Entry Events
  saveEntryBtn.addEventListener('click', ()=>{
    if(!selectedPlayer) return alert('Select a player');
    const date = entryDate.value;
    const power = Number(entryPower.value);
    if(!date || !power) return alert('Enter date and power');
    let entries = loadEntries();
    const existing = entries.find(e=>e.player===selectedPlayer && e.date===date);
    if(existing){
      existing.power = power; // update
    }else{
      entries.push({id:'id_'+Date.now(), player:selectedPlayer, date, power});
    }
    saveEntries(entries);
    entryPower.value='';
    entryDate.value='';
    renderEntries();
  });

  deleteEntryBtn.addEventListener('click', ()=>{
    if(!selectedEntryId) return alert('Select entry');
    let entries = loadEntries().filter(e=>e.id!==selectedEntryId);
    selectedEntryId=null;
    saveEntries(entries);
    renderEntries();
  });

  entriesList.addEventListener('click', e=>{
    const li = e.target.closest('li');
    if(!li) return;
    selectedEntryId = li.dataset.id;
    renderEntries();
  });

  renderPlayers();
})();
</script>
</body>
</html>