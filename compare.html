<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Compare Player Power</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body{margin:0;font-family:Inter,system-ui;background:#f8fafc;color:#1e293b;}
header{background:#1e40af;color:#fff;padding:1rem 1.5rem;display:flex;justify-content:space-between;align-items:center;}
header h1{margin:0;font-size:1.25rem;font-weight:600;}
nav{display:flex;justify-content:center;gap:10px;padding:.75rem;background:#e2e8f0;}
nav a{color:#fff;text-decoration:none;padding:.6rem 1rem;background:#3b82f6;border-radius:6px;font-weight:600;}
nav a:hover{opacity:.9;transform:translateY(-1px);}
main{max-width:1200px;margin:1.25rem auto;padding:0 1rem;}
.section{background:#ffffff;padding:1rem;border-radius:12px;box-shadow:0 6px 20px rgba(2,6,23,0.04);}
.controls{display:flex;gap:1rem;flex-wrap:wrap;margin-bottom:1rem;}
select{padding:.5rem;border-radius:6px;border:1px solid #e2e8f0;}
button{padding:.5rem 1rem;border-radius:6px;border:0;background:#10b981;color:#fff;font-weight:600;cursor:pointer;}
button:hover{background:#059669;}
</style>
</head>
<body>

<header><h1>Compare Player Power</h1></header>
<nav>
  <a href="index.html">Dashboard</a>
  <a href="compare.html">Compare</a>
</nav>

<main>
<section class="section">
<h2>Player Power Trends</h2>

<div class="controls">
  <select id="playerSelect" multiple size="6"></select>
  <button id="resetBtn">Reset Selection</button>
</div>

<canvas id="powerChart"></canvas>
</section>
</main>

<script>
const STORAGE_KEY="formData";

function loadData(){ return JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]'); }

const playerSelect=document.getElementById("playerSelect");
const resetBtn=document.getElementById("resetBtn");
const ctx=document.getElementById("powerChart").getContext("2d");
let chart=null;
const playerColors={};

function randColor(){ return `rgb(${Math.floor(Math.random()*255)},${Math.floor(Math.random()*255)},${Math.floor(Math.random()*255)})`; }

function populatePlayers(){
  const data=loadData();
  const players=[...new Set(data.map(d=>d.name))].sort();
  playerSelect.innerHTML=players.map(p=>`<option value="${p}">${p}</option>`).join('');
}

function updateChart(){
  const data=loadData();
  const selected=[...playerSelect.options].filter(o=>o.selected).map(o=>o.value);
  if(chart) chart.destroy();
  if(selected.length===0){ chart=new Chart(ctx,{type:"line",data:{labels:[],datasets:[]}}); return; }

  const dates=[...new Set(data.map(d=>d.date))].sort();
  const datasets=selected.map(player=>{
    const records=data.filter(d=>d.name===player).sort((a,b)=>a.date.localeCompare(b.date));
    if(!playerColors[player]) playerColors[player]=randColor();
    return {
      label: player,
      data: dates.map(d=>{ const e=records.find(r=>r.date===d); return e?e.power:null; }),
      borderColor: playerColors[player],
      fill:false,
      tension:0.1
    };
  });

  chart=new Chart(ctx,{
    type:"line",
    data:{labels:dates,datasets},
    options:{responsive:true,scales:{y:{beginAtZero:true}}}
  });
}

playerSelect.addEventListener("change",updateChart);
resetBtn.addEventListener("click",()=>{
  [...playerSelect.options].forEach(o=>o.selected=false);
  updateChart();
});

populatePlayers();
updateChart();
</script>

</body>
</html>